var Rest;Rest=class{constructor(e,t){this.store=e,this.baseUrl=t,this.key="id"}get(e,t,r,s){return this.rest("get",e,t,null,s,r)}add(e,t,r,s){return this.rest("add",e,t,r,s)}put(e,t,r,s){return this.rest("put",e,t,r,s)}del(e,t,r){return this.rest("del",e,t,null,r)}select(e,t,r){return this.sql("select",e,t,"",null,r)}insert(e,t){return this.sql("insert",e,{},"",t)}update(e,t){return this.sql("update",e,{},"",t)}remove(e,t){return this.sql("remove",e,t,"",null)}open(e){return this.opTable("open",e)}drop(e){return this.opTable("drop",e)}config(e){var t;return(t={}).method=this.restOp(e),t.mode="cors",t.cache="no-cache",t.redirect="follow",t.referrer="no-referrer",t.headers={"Content-Type":"application/json"},t}batch(e,t,r,s=null){var n,l;l=this.baseUrl+t.url,n=this.config("get"),fetch(l,n).then(e=>e.json()).then(n=>{if(t.result=n,this.store.batchComplete(r))return null!=s?s(r):this.store.results(e,"batch",r,id)}).catch(e=>this.store.onerror(t.table,"batch",this.toError(l,e)))}rest(e,t,r,s=null,n,l=null){var o,u;u=this.baseUrl+n,o=this.config(e),fetch(u,o).then(e=>e.json()).then(n=>{var o;return o=this.restResult(s,n),null!=l?l(o):this.store.results(t,e,o,r)}).catch(s=>this.store.onerror(t,e,this.toError(u,s),r))}sql(e,t,r,s=null,n=null){var l,o;o=this.urlRest(e,t,""),l=this.config(e),fetch(o,l).then(e=>e.json()).then(l=>{var o;return o=this.restResult(s,l,r),null!=n?n(o):this.store.results(t,e,o)}).catch(r=>this.store.onerror(t,e,this.toError(o,r)))}opTable(e,r){var s,n;n=this.urlRest(e,t,""),s=this.config(e),fetch(n,s).then(e=>e.json()).then(t=>{var s;return s=this.restResult(null,t),this.store.results(r,e,s)}).catch(t=>this.store.onerror(r,e,this.toError(n,t)))}restResult(e,t=null,r=function(){return!0}){return t}toError(e,t=null,r=null,s=null){var n;return(n={}).url=e,null!=t&&(n.error=t),null!=r&&(n.where=r),null!=s&&(n.options=s),n}urlRest(e,t,r="",s=""){switch(e){case"add":case"get":case"put":case"del":return this.baseUrl+"/"+t+"/"+r+s;case"insert":case"select":case"update":case"remove":return this.baseUrl+"/"+t+s;case"open":case"show":case"make":case"drop":return this.baseUrl+"/"+t;default:return console.error("Rest.urlRest() Unknown op",e),this.baseUrl+"/"+t+"/"+r+s}}restOp(e){switch(e){case"add":case"insert":case"open":return"POST";case"get":case"select":case"show":return"GET";case"put":case"update":case"make":return"PUT";case"del":case"remove":case"drop":return"DELETE";default:return console.error("Rest.restOp() Unknown op",e),"GET"}}};export default Rest;