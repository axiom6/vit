var Cache;Cache=class{constructor(t){this.quota=this.quota.bind(this),this.quotaGranted=this.quotaGranted.bind(this),this.onlineEvent=this.onlineEvent.bind(this),this.stream=t,this.register("../../Worker.js")}constructor2(t,e,s,r=!1){return this.stream=t,this.cacheName=e,this.cacheObjs=s,this.logPub=r,Worker.cacheName=this.cacheName,Worker.cacheObjs=this.cacheObjs,Worker.logPub=this.logPub,Worker.runCreate=!0,this.register("../../Worker.js")}constructor3(t,e,s,r=!1){return this.stream=t,this.cacheName=e,this.cacheObjs=s,this.logPub=r,this.worker=new Worker(this.cacheName,this.cacheObjs,this.logPub)}constructor4(t,e,s=!1,r){return this.cacheName=t,this.cacheObjs=e,this.logPub=s,this.stream=r,this.subject="Cache",this.subscribe(),this.onlineEvent(),this.register("./Worker.js")}register(t){if(null!=navigator.serviceWorker)return navigator.serviceWorker.register(t,{scope:"./"}).then(t=>{var e;if(e=null,null!=t.installing?e=t.installing:null!=t.waiting?e=t.waiting:t.active&&(e=t.active),null!=e)return this.publish("Register","Success")}).catch(e=>this.publish("Register",{swUrl:t},e));console.error("Cache","This browser does not suppor service workers")}publish(t,e,s=null){var r;r={status:t,text:e},null!=s&&(r.error=s),this.stream.publish(this.subject,r)}subscribe(){return this.stream.subscribe(this.subject,"Cache",this.consoleStatus)}consoleStatus(t){null!=t.error&&console.error("Cache",{status:t.status,text:t.text,error:t.error})}quota(){navigator.storageQuota.queryInfo("temporary").then((function(t){return this.publish("Quota",`Quota:${t.quota} Usage: ${t.usage}`)}))}quotaGranted(){navigator.storage.requestPersistent().then(t=>this.publish("QuotaGranted",t))}onlineEvent(){window.addEventListener("load",()=>{var t;return t=t=>{var e;e=navigator.onLine?"Online":"Offline",this.publish(e,"Cache.onlineEvent()")},window.addEventListener("online",t),window.addEventListener("offline",t)})}};export default Cache;